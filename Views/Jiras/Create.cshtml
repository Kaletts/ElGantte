@model ElGantte.Models.Jira

@{
    ViewData["Title"] = "Crear Jira";
}

<link rel="stylesheet" href="~/css/tom-select.css" />

<div class="d-flex justify-content-center align-items-center min-vh-100">
    <div class="card shadow p-4 w-75">
        <div class="row g-3">
            <!-- Formulario -->
            <div class="col-md-7">
                <h2 class="mb-3">Crear nuevo Jira</h2>
                <form asp-action="Create">
                    <div asp-validation-summary="ModelOnly" class="text-danger mb-2"></div>

                    <div class="mb-3">
                        <label asp-for="Codigo" class="form-label"></label>
                        <input asp-for="Codigo" class="form-control" required />
                        <span asp-validation-for="Codigo" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label asp-for="Descripcion" class="form-label"></label>
                        <input asp-for="Descripcion" class="form-control" required />
                        <span asp-validation-for="Descripcion" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label asp-for="Partner" class="form-label"></label>
                        <select id="partnerSelect" name="Partner" class="form-select" asp-items="ViewBag.Partner" required>
                            <option value="">Selecciona un partner</option>
                        </select>
                        <span asp-validation-for="Partner" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label asp-for="Asunto" class="form-label"></label>
                        <input asp-for="Asunto" class="form-control" required />
                        <span asp-validation-for="Asunto" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label asp-for="Responsable" class="form-label"></label>
                        <input asp-for="Responsable" class="form-control" required />
                        <span asp-validation-for="Responsable" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label asp-for="Finalizado" class="form-label"></label>
                        <select asp-for="Finalizado" class="form-select">
                            <option value="false">No</option>
                            <option value="true">Sí</option>
                        </select>
                        <span asp-validation-for="Finalizado" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label asp-for="FechaCreacion" class="form-label"></label>
                        <input asp-for="FechaCreacion" class="form-control" type="date" id="fechaCreacion" required />
                        <span asp-validation-for="FechaCreacion" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label asp-for="FechaFin" class="form-label"></label>
                        <input asp-for="FechaFin" class="form-control" type="date" />
                        <span asp-validation-for="FechaFin" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label asp-for="Url" class="form-label"></label>
                        <input asp-for="Url" class="form-control" type="url" />
                        <span asp-validation-for="Url" class="text-danger"></span>
                    </div>

                    <div class="d-grid gap-2 mt-3">
                        <input type="submit" value="Crear" class="btn btn-success" />
                        <a asp-action="Index" class="btn btn-outline-primary">Volver al inicio</a>
                    </div>
                </form>
            </div>

            <!-- SVG -->
            <div class="col-md-5 d-flex justify-content-center align-items-center">
                <svg width="350" height="350" fill="#000000" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                     xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve">
                <g>
                <path style="fill:#063e88;" d="M437.5,0h-363C33.177,0,0,33.177,0,74.5v363c0,41.323,33.177,74.5,74.5,74.5h363
                            c41.323,0,74.5-33.177,74.5-74.5v-363C512,33.177,478.823,0,437.5,0z" />
                <path style="fill:#52e6f8;" d="M256,128c-70.692,0-128,57.308-128,128s57.308,128,128,128s128-57.308,128-128
                            S326.692,128,256,128z M256,341.333c-46.934,0-85.333-38.399-85.333-85.333S209.066,170.667,256,170.667
                            S341.333,209.066,341.333,256S302.934,341.333,256,341.333z" />
                    </g>
                </svg>
            </div>
        </div>
    </div>
</div>

<script src="~/js/tom-select.complete.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Inicializar Tom-Select para Partner
        new TomSelect("#partnerSelect", {
            placeholder: "Buscar Partner...",
            create: false,
            allowEmptyOption: true
        });

        // Fecha creación por defecto (zona horaria Madrid)
        const now = new Date();
        const madridTime = new Date(now.toLocaleString("en-US", { timeZone: "Europe/Madrid" }));
        const day = String(madridTime.getDate()).padStart(2, '0');
        const month = String(madridTime.getMonth() + 1).padStart(2, '0');
        const year = madridTime.getFullYear();
        const formattedDate = `${year}-${month}-${day}`;
        document.getElementById("fechaCreacion").value = formattedDate;
    });
</script>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
